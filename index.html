<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>EarnCrypto Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #000;
      color: #fff;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    header {
      background-color: #111;
      padding: 1rem;
      text-align: center;
      font-size: 1.4rem;
      font-weight: bold;
      border-bottom: 1px solid #333;
    }

    .content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 1.5rem;
      text-align: center;
    }

    .points-box {
      background-color: #222;
      border: 1px solid #444;
      padding: 1.5rem;
      border-radius: 10px;
      font-size: 1.2rem;
      margin-bottom: 1.5rem;
      width: 100%;
      max-width: 300px;
    }

    nav {
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 0.5rem 0;
      background-color: #111;
      border-top: 1px solid #333;
      position: fixed;
      bottom: 0;
      width: 100%;
      z-index: 999;
    }

    nav a {
      color: #fff;
      text-decoration: none;
      font-size: 0.7rem;
      text-align: center;
      flex: 1;
    }

    nav a .fa {
      font-size: 1.2rem;
      display: block;
      margin-bottom: 4px;
    }

    nav a:hover {
      color: #00ff80;
    }

    .section {
      display: none;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }

    .back-btn {
      margin-top: 1rem;
      background: #444;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      cursor: pointer;
    }

    .back-btn:hover {
      background-color: #00ff80;
      color: black;
    }
  </style>
</head>
<body>
  <header>EarnCrypto</header>

  <div class="content" id="dashboard">
    <div class="points-box">
      User: <span id="username">Loading...</span><br/>
      Telegram ID: <span id="telegramId">Loading...</span><br/>
      Total Points: <span id="points">0</span> ðŸª™
    </div>
    <p>Welcome to EarnCrypto, earn points and get rewards!</p>
  </div>

  <!-- Section Containers -->
  <div id="ads" class="section">
    <h2>Watch Ads</h2>
    <iframe src="https://karangangani.github.io/Watch2earnbot/ads.html" width="100%" height="400px"></iframe>
    <button class="back-btn" onclick="goTo('dashboard')">Back</button>
  </div>

  <div id="spin" class="section">
    <h2>Spin to Win</h2>
    <iframe src="https://karangangani.github.io/Watch2earnbot/wheel.html" width="100%" height="400px"></iframe>
    <button class="back-btn" onclick="goTo('dashboard')">Back</button>
  </div>

  <div id="tasks" class="section">
    <h2>Tasks</h2>
    <iframe src="https://karangangani.github.io/Watch2earnbot/task.html" width="100%" height="400px"></iframe>
    <button class="back-btn" onclick="goTo('dashboard')">Back</button>
  </div>

  <div id="referral" class="section">
    <h2>Referral</h2>
    <iframe src="https://karangangani.github.io/Watch2earnbot/refferal.html" width="100%" height="400px"></iframe>
    <button class="back-btn" onclick="goTo('dashboard')">Back</button>
  </div>

  <div id="withdraw" class="section">
    <h2>Withdraw</h2>
    <iframe src="https://karangangani.github.io/Watch2earnbot/withdraw.html" width="100%" height="400px"></iframe>
    <button class="back-btn" onclick="goTo('dashboard')">Back</button>
  </div>

  <!-- Navigation Bar with Icons -->
  <nav>
    <a href="#" onclick="goTo('dashboard')"><i class="fa fa-home"></i>Dashboard</a>
    <a href="#" onclick="goTo('ads')"><i class="fa fa-video"></i>Ads</a>
    <a href="#" onclick="goTo('spin')"><i class="fa fa-sync-alt"></i>Spin</a>
    <a href="#" onclick="goTo('tasks')"><i class="fa fa-tasks"></i>Tasks</a>
    <a href="#" onclick="goTo('referral')"><i class="fa fa-user-friends"></i>Refer</a>
    <a href="#" onclick="goTo('withdraw')"><i class="fa fa-wallet"></i>Withdraw</a>
  </nav>

  <!-- Telegram WebApp Script -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    const tg = window.Telegram.WebApp;
    const user = tg.initDataUnsafe.user;

    const usernameSpan = document.getElementById("username");
    const telegramIdSpan = document.getElementById("telegramId");
    const pointsSpan = document.getElementById("points");

    const getPoints = () => parseInt(localStorage.getItem("points") || "0");

    const setPoints = (newPoints) => {
      localStorage.setItem("points", newPoints);
      pointsSpan.textContent = newPoints + " ðŸª™";
    }

    if (user) {
      const telegramId = user.id;
      const username = user.username || "NoUsername";
      usernameSpan.textContent = username;
      telegramIdSpan.textContent = telegramId;
      setPoints(getPoints());
    } else {
      alert("Please open this page via Telegram Mini App.");
    }

    function goTo(sectionId) {
      const sections = ["dashboard", "ads", "spin", "tasks", "referral", "withdraw"];
      sections.forEach(id => document.getElementById(id).style.display = "none");
      document.getElementById(sectionId).style.display = "flex";
    }

    goTo('dashboard');

    window.addEventListener("message", (event) => {
      if (event.data.type === "addPoints") {
        const current = getPoints();
        setPoints(current + event.data.points);
      }
    });
  </script>
</body>
  </html>
